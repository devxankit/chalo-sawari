#!/usr/bin/env node

/**
 * Google Maps API Setup Helper
 * 
 * This script helps you set up the Google Maps API key for the location autocomplete feature.
 * Run this script with: node setup-google-maps.js
 */

const fs = require('fs');
const path = require('path');
const readline = require('readline');

const rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout
});

console.log('🗺️  Google Maps API Setup Helper');
console.log('================================\n');

console.log('This script will help you configure the Google Maps API key for location autocomplete.\n');

console.log('📋 Prerequisites:');
console.log('1. A Google Cloud Platform account');
console.log('2. A billing account (Google Maps API requires billing)');
console.log('3. Your Google Maps API key\n');

console.log('🔗 Get your API key from: https://console.cloud.google.com/apis/credentials\n');

console.log('📚 Required APIs to enable:');
console.log('- Places API (for location autocomplete)');
console.log('- Maps JavaScript API (for base functionality)');
console.log('- Geocoding API (for current location feature)\n');

console.log('📖 For detailed setup instructions, see: GOOGLE_MAPS_SETUP.md\n');

rl.question('Enter your Google Maps API key: ', (apiKey) => {
  if (!apiKey || apiKey.trim() === '') {
    console.log('❌ No API key provided. Setup cancelled.');
    rl.close();
    return;
  }

  const envContent = `# Google Maps API Configuration
# Generated by setup-google-maps.js
VITE_GOOGLE_MAPS_API_KEY=${apiKey.trim()}

# Note: You need to enable these APIs in Google Cloud Console:
# 1. Places API - For location autocomplete and place details
# 2. Maps JavaScript API - For the base Google Maps functionality  
# 3. Geocoding API - For converting coordinates to addresses (current location feature)
#
# See GOOGLE_MAPS_SETUP.md for detailed setup instructions
`;

  const envPath = path.join(__dirname, '.env');
  
  try {
    fs.writeFileSync(envPath, envContent);
    console.log('✅ .env file created successfully!');
    console.log('📍 Location: ' + envPath);
    console.log('\n🚀 Next steps:');
    console.log('1. Restart your development server');
    console.log('2. Test the location autocomplete feature');
    console.log('3. Check the browser console for any errors\n');
    
    console.log('⚠️  Security reminder:');
    console.log('- Never commit your .env file to version control');
    console.log('- Consider restricting your API key in Google Cloud Console');
    console.log('- See GOOGLE_MAPS_SETUP.md for security best practices\n');
    
  } catch (error) {
    console.error('❌ Error creating .env file:', error.message);
    console.log('\n📝 Manual setup:');
    console.log('1. Create a .env file in the frontend directory');
    console.log('2. Add: VITE_GOOGLE_MAPS_API_KEY=' + apiKey.trim());
  }
  
  rl.close();
});

rl.on('close', () => {
  console.log('👋 Setup complete! Happy coding!');
});
